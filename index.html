<!DOCTYPE html>
<html>
<head>
    <title>–ö–∞—Ä—Ç–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤–µ—â–µ–π</title>
    <meta charset="utf-8">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            font-family: Arial, sans-serif;
            background: #f5f5f5;
        }
        #map { 
            height: 100vh; 
            width: 100%; 
        }
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: center;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .instructions {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 15px 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            text-align: center;
            max-width: 90%;
            z-index: 1000;
        }
        .save-btn { 
            position: fixed; 
            bottom: 20px; 
            left: 50%; 
            transform: translateX(-50%); 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; 
            padding: 15px 30px; 
            border: none; 
            border-radius: 25px; 
            font-size: 16px; 
            font-weight: bold;
            z-index: 1000;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }
        .save-btn:hover {
            transform: translateX(-50%) scale(1.05);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }
        .coordinates-info {
            position: fixed;
            top: 70px;
            left: 10px;
            background: rgba(255,255,255,0.95);
            padding: 10px 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            font-size: 12px;
            max-width: 200px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h2 style="margin: 0; font-size: 18px;">üó∫Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–µ</h2>
    </div>
    
    <div class="coordinates-info" id="coordinatesInfo">
        –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –º–µ—Å—Ç–∞
    </div>
    
    <div id="map"></div>
    
    <div class="instructions">
        üìç –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç—É —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –º–µ—Å—Ç–æ<br>
        üíæ –ó–∞—Ç–µ–º –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–µ—Å—Ç–æ"
    </div>
    
    <button class="save-btn" onclick="saveLocation()">
        üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–µ—Å—Ç–æ
    </button>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã - —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–∞–∫ –±—ã–ª
        const map = L.map('map').setView([55.7558, 37.6176], 10);
        
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ç–∞–π–ª—ã OpenStreetMap, –Ω–æ —Å –ª—É—á—à–∏–º –¥–∏–∑–∞–π–Ω–æ–º
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);

        let selectedLocation = null;
        let marker = null;

        // –ü–æ–ª—É—á–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ URL (–∫–∞–∫ –±—ã–ª–æ)
        const urlParams = new URLSearchParams(window.location.search);
        const coordsParam = urlParams.get('coords');
        
        if (coordsParam) {
            const [lat, lng] = coordsParam.split(',').map(Number);
            if (!isNaN(lat) && !isNaN(lng)) {
                selectedLocation = { lat, lng };
                // –ö—Ä–∞—Å–Ω—ã–π –º–∞—Ä–∫–µ—Ä –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –º–µ—Å—Ç–∞
                marker = L.marker([lat, lng], {
                    icon: L.divIcon({
                        className: 'saved-marker',
                        html: 'üî¥',
                        iconSize: [25, 25],
                        iconAnchor: [12, 25]
                    })
                }).addTo(map);
                map.setView([lat, lng], 15);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
                document.getElementById('coordinatesInfo').innerHTML = 
                    `üìç –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ –º–µ—Å—Ç–æ:<br>${lat.toFixed(6)}, ${lng.toFixed(6)}`;
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∫–∞—Ä—Ç–µ (—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–∞–∫ –±—ã–ª)
        map.on('click', function(e) {
            selectedLocation = e.latlng;
            
            if (marker) {
                map.removeLayer(marker);
            }
            
            // –°–∏–Ω–∏–π –º–∞—Ä–∫–µ—Ä –¥–ª—è –Ω–æ–≤–æ–≥–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –º–µ—Å—Ç–∞
            marker = L.marker([selectedLocation.lat, selectedLocation.lng], {
                icon: L.divIcon({
                    className: 'selected-marker',
                    html: 'üîµ',
                    iconSize: [30, 30],
                    iconAnchor: [15, 30]
                })
            }).addTo(map);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
            const coordsText = `–®: ${selectedLocation.lat.toFixed(6)}, –î: ${selectedLocation.lng.toFixed(6)}`;
            document.getElementById('coordinatesInfo').innerHTML = 
                `üìç –í—ã–±—Ä–∞–Ω–æ:<br>${coordsText}`;
        });

        // –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è (—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–∞–∫ –±—ã–ª)
        function saveLocation() {
            if (selectedLocation) {
                const coords = `${selectedLocation.lat},${selectedLocation.lng}`;
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram –±–æ—Ç (–∫–∞–∫ –±—ã–ª–æ)
                if (Telegram.WebApp) {
                    Telegram.WebApp.sendData(coords);
                    Telegram.WebApp.close();
                } else {
                    alert('–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã: ' + coords);
                }
            } else {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–µ!');
            }
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –∫—Ä–∞—Å–∏–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –º–∞—Å—à—Ç–∞–±–∞
        L.control.zoom({
            position: 'topright'
        }).addTo(map);
    </script>
</body>
</html>
</body>
</html>


